<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MASS: Plugin types</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo82.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MASS
   &#160;<span id="projectnumber">v0.0.1</span>
   </div>
   <div id="projectbrief">Multi-Application Support System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__home_curunir__documents__m_a_s_s__plugins__r_e_a_d_m_e.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Plugin types </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>So, as it said on the main page: </p><blockquote class="doxtable">
<p>Each plugin should have responsibility over a <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">s</a>ingle part of the functionality. </p>
</blockquote>
<p>According to this - there are only 4 main plugin types:</p><ul>
<li><b>Model</b> - business logic and communication with other plugins</li>
<li><b>View</b> - user interface</li>
<li><b>DataManager</b> - provides data structures which not related to data source (database, network, COM-port and etc.)</li>
<li><b>DataSource</b> - communicates with data source</li>
</ul>
<p>All these plugin types cover a lot of all possible application functionality. Actually, there isn't exists some special mechanism of controlling what you're doing inside your plugin - plugin type just marks you as a provider of some specific kind of functionality for other plugins.</p>
<h2>Exsisting plugins</h2>
<p>For better understanding here are presented existing plugins with their functionality:</p><ul>
<li><b>MainMenuModel</b> - holds links to plugins which available in main menu</li>
<li><b>MainMenuView</b> - provides main menu UI</li>
<li><b>TaskListModel</b> - holds information about user tasks</li>
<li><b>TaskListView</b> - shows user tasks in tree sturcture</li>
<li><b>PomodoroModel</b> - holds information about user projects and finished <a href="https://en.wikipedia.org/wiki/Pomodoro_Technique">pomodoros</a></li>
<li><b>PomodoroView</b> - allows user to run pomodoros for selected projects</li>
<li><b>TaskSketchModel</b> - holds user sketches</li>
<li><b>TaskSketchView</b> - allows user to draw sketches, save them and observe gallery of drawed sketches</li>
<li><b>AndroidNotificationsModel</b> - provides API for using specific Android features (notifications and toasts) and set alarm on Adroid devices</li>
<li><b>ExtendableDataBaseManager</b> - provides access to information in data base in abstract item models</li>
<li><b>CipherDataBaseSource</b> - provide access to <a href="https://github.com/devbean/QtCipherSqlitePlugin">SQLite plugin</a></li>
</ul>
<h2>How to make my own plugin</h2>
<h3>Step one - Create project</h3>
<p>Use custom wizard for QtCreator (<a href="https://github.com/CurunirCingar/MASS/tree/master/Docs/QtCreator%20wizard">it is here</a>). Type your plugin name and select plugin type. You should choose project directory according to your plugin type in "/Plugins" folder. </p><h3>Step two - Interacting with other plugins</h3>
<p>To interact with other plugins you should know two things about them:</p><ol type="1">
<li>Their interface</li>
<li>Their plugin type</li>
</ol>
<h4>Where to find them? In other plugins info</h4>
<p>Every plugin has its own plugin meta info. Let's look at our's plugin meta: </p><div class="fragment"><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;PluginModel&quot;,</div><div class="line">    &quot;Interface&quot;: &quot;IMyCustomModel&quot;,</div><div class="line">    &quot;Name&quot;: &quot;MyCustomModel&quot;,</div><div class="line">    &quot;RelatedPluginInterfaces&quot;: [</div><div class="line">    ]</div><div class="line">}</div></div><!-- fragment --><p> Fields "Type", "Interface" and "Name" already filled according with information that you've put on previous step. Field "RelatedPluginInterfaces" stands for relations to other plugins. If you want to interact with some plugin - you should put it's interface here. Afterwards, the linker will give you pointers to requested plugins.</p>
<p>Let's imagine that you want to interact with some data manager plugin (maybe <a href="https://github.com/CurunirCingar/MASS/tree/master/Plugins/DataManagers/ExtendableDataManager">this one</a>) and also want to exist in the main menu (<a href="https://github.com/CurunirCingar/MASS/tree/master/Plugins/Models/MainMenuModel">that one</a>).</p>
<p>You need to look into their's own plugin meta and search for field "Type" and "Interface". So, desired interfaces are "IExtendableDataManager" with type "DATAMANAGERPLUGIN" and "IMainMenuModel" with type "COREPLUGIN". For using interface in your code you need to include a header file with a description of their interface (it contains in plugin folder "i*.h").</p>
<h4>Where to put them? To your code and plugin info</h4>
<p>Put interfaces names in your plugin info: </p><div class="fragment"><div class="line">{</div><div class="line">    &quot;Type&quot;: &quot;PluginModel&quot;,</div><div class="line">    &quot;Interface&quot;: &quot;IMyCustomModel&quot;,</div><div class="line">    &quot;Name&quot;: &quot;MyCustomModel&quot;,</div><div class="line">    &quot;RelatedPluginInterfaces&quot;: [</div><div class="line">        &quot;IExtendableDataManager&quot;,</div><div class="line">        &quot;IMainMenuModel&quot;</div><div class="line">    ]</div><div class="line">}</div></div><!-- fragment --><p>Ok, next go to your generated "\*.cpp" file and look for AddReferencePlugin() method - there are example at the top of method. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> MyCustomModel::AddReferencePlugin(PluginInfo *pluginInfo)</div><div class="line">{</div><div class="line">    <span class="comment">/* Select your reference plugin type case and get it. For example:</span></div><div class="line"><span class="comment">        case MODELPLUGIN:{</span></div><div class="line"><span class="comment">            myReferencedPlugin = qobject_cast&lt;ISomePlugin*&gt;(pluginInfo-&gt;Instance);</span></div><div class="line"><span class="comment">            if(!myReferencedPlugin)</span></div><div class="line"><span class="comment">            {</span></div><div class="line"><span class="comment">                qDebug() &lt;&lt; pluginInfo-&gt;Meta-&gt;Name &lt;&lt; &quot;is not ISomePlugin.&quot;;</span></div><div class="line"><span class="comment">                return;</span></div><div class="line"><span class="comment">            }</span></div><div class="line"><span class="comment">            qDebug() &lt;&lt; &quot;ISomePlugin succesfully set.&quot;;</span></div><div class="line"><span class="comment">            connect(this, SIGNAL(OnClose(PluginInfo*)), pluginInfo-&gt;Instance, SLOT(ReferencePluginClosed(PluginInfo*)));</span></div><div class="line"><span class="comment">        } break;</span></div><div class="line"><span class="comment">    */</span></div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span>(pluginInfo-&gt;Meta-&gt;Type){</div><div class="line">    ...</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>Your requested plugins will be given to this method so you need to catch them - use interfaces and types that you've found. Interface for <b>qobject_cast</b> operation and </p><div class="fragment"><div class="line">...</div><div class="line">    <span class="keywordflow">case</span> COREPLUGIN:{</div><div class="line">        mainMenuModel = qobject_cast&lt;IMainMenuModel*&gt;(pluginInfo-&gt;Instance);</div><div class="line">        <span class="keywordflow">if</span>(!mainMenuModel)</div><div class="line">        {</div><div class="line">            qDebug() &lt;&lt; pluginInfo-&gt;Meta-&gt;Name &lt;&lt; <span class="stringliteral">&quot;is not IMainMenuModel.&quot;</span>;</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">        }</div><div class="line">        qDebug() &lt;&lt; <span class="stringliteral">&quot;IMainMenuModel succesfully set.&quot;</span>;</div><div class="line">        connect(<span class="keyword">this</span>, SIGNAL(OnClose(PluginInfo*)), pluginInfo-&gt;Instance, SLOT(ReferencePluginClosed(PluginInfo*)));</div><div class="line">    } <span class="keywordflow">break</span>;</div><div class="line">    <span class="keywordflow">case</span> DATAMANAGERPLUGIN:{</div><div class="line">        extendableDataManager = qobject_cast&lt;<a class="code" href="class_i_extendable_data_manager.html">IExtendableDataManager</a>*&gt;(pluginInfo-&gt;Instance);</div><div class="line">        <span class="keywordflow">if</span>(!extendableDataManager)</div><div class="line">        {</div><div class="line">            qDebug() &lt;&lt; pluginInfo-&gt;Meta-&gt;Name &lt;&lt; <span class="stringliteral">&quot;is not IExtendableDataManager.&quot;</span>;</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">        }</div><div class="line">        qDebug() &lt;&lt; <span class="stringliteral">&quot;IExtendableDataManager succesfully set.&quot;</span>;</div><div class="line">        connect(<span class="keyword">this</span>, SIGNAL(OnClose(PluginInfo*)), pluginInfo-&gt;Instance, SLOT(ReferencePluginClosed(PluginInfo*)));</div><div class="line">    }<span class="keywordflow">break</span>;</div><div class="line">...</div><div class="line">}</div></div><!-- fragment --><p><b>Subtle moment:</b> in method AddReferencePlugin() only <b>you</b> get pointer to plugin - referenced plugins ("IMainMenuModel" and "IExtendableDataManager") doesn't know a thing about you. There are could be plugins that could be needed your pointer for proper work. For example - main menu plugin (IMainMenuModel) will show your plugin on the menu only if you'll add it as a reference via his AddReferencePlugin(). So, for existing in the main menu you should append: </p><div class="fragment"><div class="line">...</div><div class="line">qDebug() &lt;&lt; <span class="stringliteral">&quot;IExtendableDataManager succesfully set.&quot;</span>;</div><div class="line">**mainMenuModel-&gt;AddReferencePlugin(this-&gt;pluginInfo);**</div><div class="line">...</div></div><!-- fragment --><h3>Step three - Providing interface to others</h3>
<p>As other plugins you also have an interface - it also generated with the wizard: </p><div class="fragment"><div class="line"><span class="keyword">class </span>IMyCustomModel :</div><div class="line">        <span class="keyword">public</span> IModelPlugin</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="comment">// Write your interface methods here</span></div><div class="line">};</div></div><!-- fragment --><p> So, if you want to provide some functionality to system - go ahead :)</p>
<h2>How to build all</h2>
<p>There are "plugins.pro" file in "/Plugins" folder - by using it you could build all plugins. </p><h2>In "/Application" folder you could use "MASS.pro" file for build main application. </h2>
<p><em>P.S.:</em> Currently I'm working on this documentation - so if you have some questions: <a href="#" onclick="location.href='mai'+'lto:'+'cur'+'un'+'ir@'+'ya'+'nde'+'x.'+'ru'; return false;">curun<span style="display: none;">.nosp@m.</span>ir@y<span style="display: none;">.nosp@m.</span>andex<span style="display: none;">.nosp@m.</span>.ru</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Apr 7 2019 20:02:56 for MASS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
